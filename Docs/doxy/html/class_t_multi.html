<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Gems3k: TMulti Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Gems3k
   &#160;<span id="projectnumber">3.2</span>
   </div>
   <div id="projectbrief">GEMS3K standalone solver for geochemical equilibria</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a>  </div>
  <div class="headertitle">
<div class="title">TMulti Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="TMulti" -->
<p><a href="class_t_multi-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0cf870bf518661f593716fb2d8c0c9e0"></a><!-- doxytag: member="TMulti::set_def" ref="a0cf870bf518661f593716fb2d8c0c9e0" args="(long int i=0)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a0cf870bf518661f593716fb2d8c0c9e0">set_def</a> (long int i=0)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Set default information. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abfa420e91214d1d42aa1654248f270e6"></a><!-- doxytag: member="TMulti::TMulti" ref="abfa420e91214d1d42aa1654248f270e6" args="(TNode *na_)" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#abfa420e91214d1d42aa1654248f270e6">TMulti</a> (<a class="el" href="class_t_node.html">TNode</a> *na_)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">This allocation is used only in standalone GEMS3K. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae10364c691da3aeae7ab6f17bc57ca4c"></a><!-- doxytag: member="TMulti::multi_realloc" ref="ae10364c691da3aeae7ab6f17bc57ca4c" args="(char PAalp, char PSigm)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#ae10364c691da3aeae7ab6f17bc57ca4c">multi_realloc</a> (char PAalp, char PSigm)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Realloc dynamic memory. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7870f0d4f146b5c0a8866d6cd3f5ce18"></a><!-- doxytag: member="TMulti::multi_free" ref="a7870f0d4f146b5c0a8866d6cd3f5ce18" args="()" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a7870f0d4f146b5c0a8866d6cd3f5ce18">multi_free</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Reallocation of dynamic memory. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6665896960549e2dc0818f94c4c51506"></a><!-- doxytag: member="TMulti::CheckMtparam" ref="a6665896960549e2dc0818f94c4c51506" args="()" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a6665896960549e2dc0818f94c4c51506">CheckMtparam</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Test and load thermodynamic data from GEMS project database. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae3eb99cf39d95a47dcf6933901014206"></a><!-- doxytag: member="TMulti::GetPM" ref="ae3eb99cf39d95a47dcf6933901014206" args="()" -->
<a class="el" href="struct_m_u_l_t_i.html">MULTI</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>GetPM</b> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9e4178f2931cfd5c9cc8acc70d14ec57"></a><!-- doxytag: member="TMulti::setPa" ref="a9e4178f2931cfd5c9cc8acc70d14ec57" args="(TProfil *prof)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>setPa</b> (<a class="el" href="class_t_profil.html">TProfil</a> *prof)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad456a03d33685cd1d4f5d2356a448b82"></a><!-- doxytag: member="TMulti::testMulti" ref="ad456a03d33685cd1d4f5d2356a448b82" args="()" -->
long int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#ad456a03d33685cd1d4f5d2356a448b82">testMulti</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Output to "ipmlog.txt" file Warnings. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac32650c3da493d9349b4347740a450b2"></a><!-- doxytag: member="TMulti::GetName" ref="ac32650c3da493d9349b4347740a450b2" args="() const " -->
const char *&#160;</td><td class="memItemRight" valign="bottom"><b>GetName</b> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae254ebc48ba6d8d8bbd6983401b09274"></a><!-- doxytag: member="TMulti::to_file" ref="ae254ebc48ba6d8d8bbd6983401b09274" args="(GemDataStream &amp;ff)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#ae254ebc48ba6d8d8bbd6983401b09274">to_file</a> (<a class="el" href="class_gem_data_stream.html">GemDataStream</a> &amp;ff)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Writing <a class="el" href="struct_m_u_l_t_i.html" title="Contains chemical thermodynamic work data for GEM IPM-3 algorithm.">MULTI</a> to binary file. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a05167a330deedfc870298910f2dd5d2e"></a><!-- doxytag: member="TMulti::to_text_file" ref="a05167a330deedfc870298910f2dd5d2e" args="(const char *path, bool append=false)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a05167a330deedfc870298910f2dd5d2e">to_text_file</a> (const char *path, bool append=false)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Writing structure <a class="el" href="struct_m_u_l_t_i.html" title="Contains chemical thermodynamic work data for GEM IPM-3 algorithm.">MULTI</a> ( free format file ) <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4775ee22d0c6ed22e9e408b605aa00ab"></a><!-- doxytag: member="TMulti::from_file" ref="a4775ee22d0c6ed22e9e408b605aa00ab" args="(GemDataStream &amp;ff)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a4775ee22d0c6ed22e9e408b605aa00ab">from_file</a> (<a class="el" href="class_gem_data_stream.html">GemDataStream</a> &amp;ff)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Reading <a class="el" href="struct_m_u_l_t_i.html" title="Contains chemical thermodynamic work data for GEM IPM-3 algorithm.">MULTI</a> from binary file. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a76d4ec8f288af3132f0e5bc8b23c0a66"></a><!-- doxytag: member="TMulti::to_text_file_gemipm" ref="a76d4ec8f288af3132f0e5bc8b23c0a66" args="(const char *path, bool addMui, bool with_comments=true, bool brief_mode=false)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a76d4ec8f288af3132f0e5bc8b23c0a66">to_text_file_gemipm</a> (const char *path, bool addMui, bool with_comments=true, bool brief_mode=false)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Writing structure <a class="el" href="struct_m_u_l_t_i.html" title="Contains chemical thermodynamic work data for GEM IPM-3 algorithm.">MULTI</a> (GEM IPM work structure) <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad1367f8aaa802db0331ab02eb7c1b844"></a><!-- doxytag: member="TMulti::from_text_file_gemipm" ref="ad1367f8aaa802db0331ab02eb7c1b844" args="(const char *path, DATACH *dCH)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#ad1367f8aaa802db0331ab02eb7c1b844">from_text_file_gemipm</a> (const char *path, <a class="el" href="struct_d_a_t_a_c_h.html">DATACH</a> *dCH)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Reading structure <a class="el" href="struct_m_u_l_t_i.html" title="Contains chemical thermodynamic work data for GEM IPM-3 algorithm.">MULTI</a> (GEM IPM work structure) <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a28b4fa69e76546acd0edd50c84139a01"></a><!-- doxytag: member="TMulti::Alloc_internal" ref="a28b4fa69e76546acd0edd50c84139a01" args="()" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a28b4fa69e76546acd0edd50c84139a01">Alloc_internal</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal memory allocation for IPM performance optimization. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a831477262b912255cb37321212657962">CalculateEquilibriumState</a> (long int typeMin, long int &amp;NumIterFIA, long int &amp;NumIterIPM)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Main call to GEM IPM calculation of equilibrium state in <a class="el" href="struct_m_u_l_t_i.html" title="Contains chemical thermodynamic work data for GEM IPM-3 algorithm.">MULTI</a> (with internal re-scaling of the system).  <a href="#a831477262b912255cb37321212657962"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a11854dd39bbc3530debddde81bc94c42"></a><!-- doxytag: member="TMulti::InitalizeGEM_IPM_Data" ref="a11854dd39bbc3530debddde81bc94c42" args="()" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a11854dd39bbc3530debddde81bc94c42">InitalizeGEM_IPM_Data</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculation by IPM (preparing for calculation, unpacking data) In IPM. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acd7417b0053280565ddfa235c9c8bfe2"></a><!-- doxytag: member="TMulti::DC_LoadThermodynamicData" ref="acd7417b0053280565ddfa235c9c8bfe2" args="(TNode *aNa=0)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#acd7417b0053280565ddfa235c9c8bfe2">DC_LoadThermodynamicData</a> (<a class="el" href="class_t_node.html">TNode</a> *aNa=0)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Load Thermodynamic Data from <a class="el" href="struct_d_a_t_a_c_h.html" title="Data for CHemistry data structure.">DATACH</a> to <a class="el" href="struct_m_u_l_t_i.html" title="Contains chemical thermodynamic work data for GEM IPM-3 algorithm.">MULTI</a> using Lagrangian Interpolator. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">long int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#aaebbf6d96e7cf89e432688a584819253">CheckMassBalanceResiduals</a> (double *Y)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Diagnostics for a severe break of mass balance (abs.moles) after GEM IPM <a class="el" href="class_t_multi.html#ab0987119ad690a52fb5ee10922f19a8d" title="Checking Karpov phase stability criteria Fa for phases and DCs.">PhaseSelect()</a>.  <a href="#aaebbf6d96e7cf89e432688a584819253"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a365fdf25b48d55278da79c12e339eeb3">ConvertGj_toUniformStandardState</a> (double g0, long int j, long int k)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Conversion of g(T,P) value for DCs into the uniform cj scale.  <a href="#a365fdf25b48d55278da79c12e339eeb3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a4bd5e994af5113e2be07d6540a1f6cde">PhaseSpecificGamma</a> (long int j, long int jb, long int je, long int k, long int DirFlag=0L)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for converting internal lnGam[j] value into an external (phase-scale-specific) Gamma[j] if DirFlag = 0 or external into internal value if DirFlag = 1.  <a href="#a4bd5e994af5113e2be07d6540a1f6cde"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#af8cd7213884c0420eb1e86b850c06254">HelmholtzEnergy</a> (double x)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls to minimization of other system potentials - HelmholtzEnergy.  <a href="#af8cd7213884c0420eb1e86b850c06254"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a12af02446fdc8df715cc57f4a348415a">InternalEnergy</a> (double TC, double P)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls to minimization of other system potentials - InternalEnergy.  <a href="#a12af02446fdc8df715cc57f4a348415a"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a63c50cdd567188eafb223578491d1e84"></a><!-- doxytag: member="TMulti::node" ref="a63c50cdd567188eafb223578491d1e84" args="" -->
<a class="el" href="class_t_node.html">TNode</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>node</b></td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae5f83210424898c637d9d88eccdd9c05"></a><!-- doxytag: member="TMulti::Alloc_TSolMod" ref="ae5f83210424898c637d9d88eccdd9c05" args="(long int newFIs)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#ae5f83210424898c637d9d88eccdd9c05">Alloc_TSolMod</a> (long int newFIs)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal memory allocation for <a class="el" href="class_t_sol_mod.html">TSolMod</a> performance optimization (since version 2.3.0) <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1407798a9f7d38b6878361c2d33ea545"></a><!-- doxytag: member="TMulti::Free_TSolMod" ref="a1407798a9f7d38b6878361c2d33ea545" args="()" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>Free_TSolMod</b> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5f6682afde0e31bdc6f60d9d83e74fcf"></a><!-- doxytag: member="TMulti::Alloc_uDD" ref="a5f6682afde0e31bdc6f60d9d83e74fcf" args="(long int newN)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a5f6682afde0e31bdc6f60d9d83e74fcf">Alloc_uDD</a> (long int newN)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Added for implementation of divergence detection in dual solution 06.05.2011 DK. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a949062718030dcab8f8a23fbe53dcae8"></a><!-- doxytag: member="TMulti::Free_uDD" ref="a949062718030dcab8f8a23fbe53dcae8" args="()" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>Free_uDD</b> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab4daea01f1e6f4d3d2d1c680552d2fdb"></a><!-- doxytag: member="TMulti::Reset_uDD" ref="ab4daea01f1e6f4d3d2d1c680552d2fdb" args="(long int cr, bool trace=false)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#ab4daea01f1e6f4d3d2d1c680552d2fdb">Reset_uDD</a> (long int cr, bool trace=false)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">initializing data for u divergence detection <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af0c3f541b9d841abb04617e135174e8c"></a><!-- doxytag: member="TMulti::Increment_uDD" ref="af0c3f541b9d841abb04617e135174e8c" args="(long int r, bool trace=false)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#af0c3f541b9d841abb04617e135174e8c">Increment_uDD</a> (long int r, bool trace=false)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Incrementing mean u values for r-th (current) IPM iteration. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">long int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#adeccd4c29eb9e9ff3a51e202ec36e145">Check_uDD</a> (long int mode, double DivTol, bool trace=false)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Checking for divergence in coef.variation of dual solution approximation.  <a href="#adeccd4c29eb9e9ff3a51e202ec36e145"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab38c76917342a039ec3212b7a1f5aebe"></a><!-- doxytag: member="TMulti::getLsModsum" ref="ab38c76917342a039ec3212b7a1f5aebe" args="(long int &amp;LsModSum, long int &amp;LsIPxSum)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>getLsModsum</b> (long int &amp;LsModSum, long int &amp;LsIPxSum)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a772e99d458a74b6d277138983968ad07"></a><!-- doxytag: member="TMulti::getLsMdcsum" ref="a772e99d458a74b6d277138983968ad07" args="(long int &amp;LsMdcSum, long int &amp;LsMsnSum, long int &amp;LsSitSum)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>getLsMdcsum</b> (long int &amp;LsMdcSum, long int &amp;LsMsnSum, long int &amp;LsSitSum)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0355b07985649501d6657e86f614c9e6"></a><!-- doxytag: member="TMulti::setErrorMessage" ref="a0355b07985649501d6657e86f614c9e6" args="(long int num, const char *code, const char *msg)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>setErrorMessage</b> (long int num, const char *code, const char *msg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0a5687ff395f2701e4325d541b3154c4"></a><!-- doxytag: member="TMulti::addErrorMessage" ref="a0a5687ff395f2701e4325d541b3154c4" args="(const char *msg)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>addErrorMessage</b> (const char *msg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#ae55b4573ef1259a75c30a21cd73ccee9">XmaxSAT_IPM2</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculation of max.moles of surface species for SACT stabilization to improve IPM-2 convergence at high SACT values.  <a href="#ae55b4573ef1259a75c30a21cd73ccee9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a983762b812112f1e45925f8557a7c79c"></a><!-- doxytag: member="TMulti::DC_DualChemicalPotential" ref="a983762b812112f1e45925f8557a7c79c" args="(double U[], double AL[], long int N, long int j)" -->
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a983762b812112f1e45925f8557a7c79c">DC_DualChemicalPotential</a> (double U[], double AL[], long int N, long int j)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculating value of dual chemical potential of j-th dependent component performance optimized version (February 2007) <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#aa633a2ab673b0eeea4c36ac10ac4f86d">Set_DC_limits</a> (long int Mode)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">This procedure sets kinetic constraints according to a given concentration units.  <a href="#aa633a2ab673b0eeea4c36ac10ac4f86d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a90d0002d2ef9d9916cf1e2fa22a2c1f1"></a><!-- doxytag: member="TMulti::TotalPhasesAmounts" ref="a90d0002d2ef9d9916cf1e2fa22a2c1f1" args="(double X[], double XF[], double XFA[])" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a90d0002d2ef9d9916cf1e2fa22a2c1f1">TotalPhasesAmounts</a> (double X[], double XF[], double XFA[])</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculating total amounts of phases. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a852f7489d1ea8698cc4ef1363f0e5e38">DC_PrimalChemicalPotentialUpdate</a> (long int j, long int k)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Corrections to primal chemical potentials F0[j] of j-th species in k-th phase among IPM main iterations.  <a href="#a852f7489d1ea8698cc4ef1363f0e5e38"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a173495b5c98735bd69fd9b91f6ef066c">DC_PrimalChemicalPotential</a> (double G, double logY, double logYF, double asTail, double logYw, char DCCW)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculation of DC primal chemical potential F.  <a href="#a173495b5c98735bd69fd9b91f6ef066c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6dd8aa4d1c072e17ab160907ff6a5df7"></a><!-- doxytag: member="TMulti::PrimalChemicalPotentials" ref="a6dd8aa4d1c072e17ab160907ff6a5df7" args="(double F[], double Y[], double YF[], double YFA[])" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a6dd8aa4d1c072e17ab160907ff6a5df7">PrimalChemicalPotentials</a> (double F[], double Y[], double YF[], double YFA[])</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">VJ - Update of primal chemical potentials. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afda8d27eb9a2c64f620c5a24d70c0216"></a><!-- doxytag: member="TMulti::KarpovCriterionDC" ref="afda8d27eb9a2c64f620c5a24d70c0216" args="(double *dNuG, double logYF, double asTail, double logYw, double Wx, char DCCW)" -->
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#afda8d27eb9a2c64f620c5a24d70c0216">KarpovCriterionDC</a> (double *dNuG, double logYF, double asTail, double logYw, double Wx, char DCCW)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculation of Karpov stability criteria for a DC. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a46b67e8a4a79524167a773f6625d4061"></a><!-- doxytag: member="TMulti::KarpovsPhaseStabilityCriteria" ref="a46b67e8a4a79524167a773f6625d4061" args="()" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a46b67e8a4a79524167a773f6625d4061">KarpovsPhaseStabilityCriteria</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculation of Karpov stability criteria for all phases. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae23c3b67e005d184be639ad3273a66e8"></a><!-- doxytag: member="TMulti::StabilityIndexes" ref="ae23c3b67e005d184be639ad3273a66e8" args="()" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#ae23c3b67e005d184be639ad3273a66e8">StabilityIndexes</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculation of (logarithmic) stability indexes logSI for all phases. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#ae51cf1a690d7c2b1ea5498a0b2373bc4">DC_GibbsEnergyContribution</a> (double G, double x, double logXF, double logXw, char DCCW)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculation of a species contribution to the total Gibbs energy G(X) of the system.  <a href="#ae51cf1a690d7c2b1ea5498a0b2373bc4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a3042adac38b4156709da3e6928dda984">GX</a> (double LM)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculation of the total Gibbs energy of the system G(X) and copying of Y, YF vectors into X,XF, respectively.  <a href="#a3042adac38b4156709da3e6928dda984"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a98aa32f2c652311538b3cdcf467e1548"></a><!-- doxytag: member="TMulti::ConvertDCC" ref="a98aa32f2c652311538b3cdcf467e1548" args="()" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a98aa32f2c652311538b3cdcf467e1548">ConvertDCC</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Converting DC class codes into generic internal codes of IPM. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac07143c37681b84f8ecbb3a0a3461877"></a><!-- doxytag: member="TMulti::getXvolume" ref="ac07143c37681b84f8ecbb3a0a3461877" args="()" -->
long int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#ac07143c37681b84f8ecbb3a0a3461877">getXvolume</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the index of volume IC ("Vv") for the volume balance constraint. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afc4511983c92576df29c46acd8a857d4"></a><!-- doxytag: member="TMulti::GasParcP" ref="afc4511983c92576df29c46acd8a857d4" args="()" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#afc4511983c92576df29c46acd8a857d4">GasParcP</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculating demo partial pressures of gases (works only in GEMS-PSI) <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a88bea652d676272b01f1c611da7dde9e"></a><!-- doxytag: member="TMulti::phase_bcs" ref="a88bea652d676272b01f1c611da7dde9e" args="(long int N, long int M, long int jb, double *A, double X[], double BF[])" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a88bea652d676272b01f1c611da7dde9e">phase_bcs</a> (long int N, long int M, long int jb, double *A, double X[], double BF[])</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculating bulk stoichiometry of a multicomponent phase. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac8babff2031eb510caef868b53b195d6"></a><!-- doxytag: member="TMulti::phase_bfc" ref="ac8babff2031eb510caef868b53b195d6" args="(long int k, long int jj)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#ac8babff2031eb510caef868b53b195d6">phase_bfc</a> (long int k, long int jj)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds phase to total bulk stoichiometry of all solid phases in the system. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5270522d4b88664c2d3d28866dff9f8f"></a><!-- doxytag: member="TMulti::bfc_mass" ref="a5270522d4b88664c2d3d28866dff9f8f" args="(void)" -->
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a5270522d4b88664c2d3d28866dff9f8f">bfc_mass</a> (void)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns mass of all solid phases in grams (from the BFC vector) <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a7e0bef8039395c1a3a44d96026e210ed">CalculateConcentrationsInPhase</a> (double X[], double XF[], double XFA[], double Factor, double MMC, double Dsur, long int jb, long int je, long int k)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculation of dual chemical potentials, activities, and primal concentrations for DCs (indexed jb to je) in a k-th phase.  <a href="#a7e0bef8039395c1a3a44d96026e210ed"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a5da155d74ac7092b36347caeec4f50a3">CalculateConcentrations</a> (double X[], double XF[], double XFA[])</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculation of derived values (concentrations etc.) on IPM iteration from X,XF, and XFA vectors.  <a href="#a5da155d74ac7092b36347caeec4f50a3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">long int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a787e4e93758b94959ea8c624664569eb">GouyChapman</a> (long int jb, long int je, long int k)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculation of the surface potential pm[q].XpsiD[k] on diffuse.  <a href="#a787e4e93758b94959ea8c624664569eb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">long int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#ab41f91ff6ae502782679542f01818b63">SurfaceActivityCoeff</a> (long int jb, long int je, long int jpb, long int jdb, long int k)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculation of new surface activity coefficient terms SACT (Kulik, 2004)  <a href="#ab41f91ff6ae502782679542f01818b63"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6e7660cf3c63beff3eb765efc7de399c"></a><!-- doxytag: member="TMulti::IS_EtaCalc" ref="a6e7660cf3c63beff3eb765efc7de399c" args="()" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a6e7660cf3c63beff3eb765efc7de399c">IS_EtaCalc</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculation of surface charge densities on multi-surface sorption phase. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a64fe1c6b46ba7ba6e692eb026140fd11"></a><!-- doxytag: member="TMulti::pm_GC_ods_link" ref="a64fe1c6b46ba7ba6e692eb026140fd11" args="(long int k, long int jb, long int jpb, long int jdb, long int ipb)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a64fe1c6b46ba7ba6e692eb026140fd11">pm_GC_ods_link</a> (long int k, long int jb, long int jpb, long int jdb, long int ipb)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Linking DOD for executing Phase mixing model scripts. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a400ed0e8bea020a8cbaad9050fa81eb5"></a><!-- doxytag: member="TMulti::SmoothingFactor" ref="a400ed0e8bea020a8cbaad9050fa81eb5" args="()" -->
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a400ed0e8bea020a8cbaad9050fa81eb5">SmoothingFactor</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns current value of smoothing factor for chemical potentials of highly non-ideal DCs. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#ad47aa9e7ee1a16f552b1f5c079bc61f4">SetSmoothingFactor</a> (long int mode)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">New correction of smoothing factor for highly non-ideal systems.  <a href="#ad47aa9e7ee1a16f552b1f5c079bc61f4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">long int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a97568fb4779b7b69af4ca16bce51864e">CalculateActivityCoefficients</a> (long int LinkMode)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Main call point for calculation of DC activity coefficients (lnGam vector) formerly GammaCalc().  <a href="#a97568fb4779b7b69af4ca16bce51864e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#acee19c49cf66d2be5bb86db0883c40cd">SolModCreate</a> (long int jb, long int jmb, long int jsb, long int jpb, long int jdb, long int k, long int ipb, char ModCode, char MixCode)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper calls for creating multi-component mixing models for phases using <a class="el" href="class_t_sol_mod.html">TSolMod</a> class.  <a href="#acee19c49cf66d2be5bb86db0883c40cd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac3ab154fdef266b0c3f1fa81c9dbc17f"></a><!-- doxytag: member="TMulti::SolModParPT" ref="ac3ab154fdef266b0c3f1fa81c9dbc17f" args="(long int k, char ModCode)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#ac3ab154fdef266b0c3f1fa81c9dbc17f">SolModParPT</a> (long int k, char ModCode)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper call for calculation of temperature and pressure correction uses <a class="el" href="class_t_sol_mod.html">TSolMod</a> class. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1f59b6c821753efe7c6caf4f96b85924"></a><!-- doxytag: member="TMulti::SolModActCoeff" ref="a1f59b6c821753efe7c6caf4f96b85924" args="(long int k, char ModCode)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a1f59b6c821753efe7c6caf4f96b85924">SolModActCoeff</a> (long int k, char ModCode)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper call for calculation of activity coefficients uses <a class="el" href="class_t_sol_mod.html">TSolMod</a> class. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa06da1cfc394d2b99b2ec6dc4de0959a"></a><!-- doxytag: member="TMulti::SolModExcessProp" ref="aa06da1cfc394d2b99b2ec6dc4de0959a" args="(long int k, char ModCode)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#aa06da1cfc394d2b99b2ec6dc4de0959a">SolModExcessProp</a> (long int k, char ModCode)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper call for calculation of bulk phase excess properties uses <a class="el" href="class_t_sol_mod.html">TSolMod</a> class. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a611349957815ac7f4ee0be4c9fb74382"></a><!-- doxytag: member="TMulti::SolModIdealProp" ref="a611349957815ac7f4ee0be4c9fb74382" args="(long int jb, long int k, char ModCode)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a611349957815ac7f4ee0be4c9fb74382">SolModIdealProp</a> (long int jb, long int k, char ModCode)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper call for calculation of bulk phase ideal mixing properties. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a74386f9c13949493b3a28afcc5218a2e"></a><!-- doxytag: member="TMulti::SolModStandProp" ref="a74386f9c13949493b3a28afcc5218a2e" args="(long int jb, long int k, char ModCode)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a74386f9c13949493b3a28afcc5218a2e">SolModStandProp</a> (long int jb, long int k, char ModCode)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper call for retrieving bulk phase standard state terms. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a84c1048e0361d94ac8310a6df6059b0e"></a><!-- doxytag: member="TMulti::SolModDarkenProp" ref="a84c1048e0361d94ac8310a6df6059b0e" args="(long int jb, long int k, char ModCode)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a84c1048e0361d94ac8310a6df6059b0e">SolModDarkenProp</a> (long int jb, long int k, char ModCode)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper call for retrieving bulk phase Darken quadratic terms. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a6b8d1a27f84d3f707fa6d1cba1c3c2d5">GEM_IPM</a> (long int rLoop)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Main sequence of GEM IPM algorithm implementation.  <a href="#a6b8d1a27f84d3f707fa6d1cba1c3c2d5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">long int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#aa21ef549ee562d688a3aa1e84f2f8c9a">MassBalanceRefinement</a> (long int WhereCalledFrom)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculation of a feasible IPM approximation, refinement of the mass balance.  <a href="#aa21ef549ee562d688a3aa1e84f2f8c9a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">long int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#ae0ce862b92fb59c63df3badc9a0c0eb1">InteriorPointsMethod</a> (long int &amp;status, long int rLoop)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculation of chemical equilibrium using the Interior Points Method algorithm (see Karpov et al., 1997, p.  <a href="#ae0ce862b92fb59c63df3badc9a0c0eb1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a4f5cd5279e3e52c40dae42721883e0ea">AutoInitialApproximation</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculation of LPP-based automatic initial approximation of the primal vector x.  <a href="#a4f5cd5279e3e52c40dae42721883e0ea"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#ac29d91460e0a7fbd4ea989352348af45">MassBalanceResiduals</a> (long int N, long int L, double *A, double *Y, double *B, double *C)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculation of mass-balance residuals in GEM IPM CSD.  <a href="#ac29d91460e0a7fbd4ea989352348af45"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a1eae05db545806122b7a640d64c942a5">OptimizeStepSize</a> (double LM)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Interior Points Method subroutine for unconditional optimization of the descent step length on the interval 0 to LM.  <a href="#a1eae05db545806122b7a640d64c942a5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adb19aba8fd8d5cae09acefdb5d743bc9"></a><!-- doxytag: member="TMulti::DC_ZeroOff" ref="adb19aba8fd8d5cae09acefdb5d743bc9" args="(long int jStart, long int jEnd, long int k=&#45;1L)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#adb19aba8fd8d5cae09acefdb5d743bc9">DC_ZeroOff</a> (long int jStart, long int jEnd, long int k=-1L)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Cleaning the unstable phase with index k &gt;= 0 (if k &lt; 0 only DC will be cleaned) <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#aaff2948482e2bfe7979e0c187611793e">DC_RaiseZeroedOff</a> (long int jStart, long int jEnd, long int k=-1L)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Inserting minor quantities of DC which were zeroed off by <a class="el" href="class_t_multi.html#ad3a6b3872de4edcecd60e6850536cee6" title="Generic simplex method with two sided constraints (c) K.Chudnenko 1992.">SolveSimplex()</a>.  <a href="#aaff2948482e2bfe7979e0c187611793e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adc1e15304fb9ff1074a733e83b250cde"></a><!-- doxytag: member="TMulti::RaiseDC_Value" ref="adc1e15304fb9ff1074a733e83b250cde" args="(const long int j)" -->
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#adc1e15304fb9ff1074a733e83b250cde">RaiseDC_Value</a> (const long int j)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">New function to improve on raising zero values in <a class="el" href="class_t_multi.html#ab0987119ad690a52fb5ee10922f19a8d" title="Checking Karpov phase stability criteria Fa for phases and DCs.">PhaseSelect()</a> and after <a class="el" href="class_t_multi.html#ad3a6b3872de4edcecd60e6850536cee6" title="Generic simplex method with two sided constraints (c) K.Chudnenko 1992.">SolveSimplex()</a> <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad6bec948f22581dfdad6485d813487e9"></a><!-- doxytag: member="TMulti::MetastabilityLagrangeMultiplier" ref="ad6bec948f22581dfdad6485d813487e9" args="()" -->
long int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#ad6bec948f22581dfdad6485d813487e9">MetastabilityLagrangeMultiplier</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adjustment of primal approximation according to kinetic constraints. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a100d3c7555621eccd5d58339e264ba5d"></a><!-- doxytag: member="TMulti::WeightMultipliers" ref="a100d3c7555621eccd5d58339e264ba5d" args="(bool square)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a100d3c7555621eccd5d58339e264ba5d">WeightMultipliers</a> (bool square)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculation of weight multipliers for DCs. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">long int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a82af3be3535af9157e8acf16b7ebadb2">MakeAndSolveSystemOfLinearEquations</a> (long int N, bool initAppr)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Make and Solve a system of linear equations to find the dual vector approximation using a method of Cholesky Decomposition.  <a href="#a82af3be3535af9157e8acf16b7ebadb2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a0245f972e785fcb412ab228d6194b1fa">DikinsCriterion</a> (long int N, bool initAppr)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculation of MU values (in the vector of direction of descent) and Dikin criterion.  <a href="#a0245f972e785fcb412ab228d6194b1fa"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#ac7ddcf02e7b9c26fdc310738c7450d12">StepSizeEstimate</a> (bool initAppr)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Estimation of the descent step length LM.  <a href="#ac7ddcf02e7b9c26fdc310738c7450d12"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4a4f82f7d655957702c0cead398b6f30"></a><!-- doxytag: member="TMulti::Restore_Y_YF_Vectors" ref="a4a4f82f7d655957702c0cead398b6f30" args="()" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a4a4f82f7d655957702c0cead398b6f30">Restore_Y_YF_Vectors</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Restoring primal vectors Y and YF. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac2c0619e172e9e42f26552861ece5036"></a><!-- doxytag: member="TMulti::RescaleToSize" ref="ac2c0619e172e9e42f26552861ece5036" args="(bool standard_size)" -->
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#ac2c0619e172e9e42f26552861ece5036">RescaleToSize</a> (bool standard_size)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculation of the system size scaling factor and modified thresholds/cutoffs/insertion values Replaces calcSfactor() <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">long int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#ad8826f14b647c15202974c46a9cf4e1f">SpeciationCleanup</a> (double AmountThreshold, double ChemPotDiffCutoff)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Speciation cleanup subroutine if CleanupStatus is not zero.  <a href="#ad8826f14b647c15202974c46a9cf4e1f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">long int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a1ff7224c7dcfd5aa2d6c6792af6039d8">PhaseSelectionSpeciationCleanup</a> (long int &amp;k_miss, long int &amp;k_unst, long int rLoop)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">New simplified PSSC() algorithm DK 01.05.2010.  <a href="#a1ff7224c7dcfd5aa2d6c6792af6039d8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">long int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#ab0987119ad690a52fb5ee10922f19a8d">PhaseSelect</a> (long int &amp;k_miss, long int &amp;k_unst, long int rLoop)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Checking Karpov phase stability criteria Fa for phases and DCs.  <a href="#ab0987119ad690a52fb5ee10922f19a8d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a3a94652d7d7d01f34b4806fa6626a556">GEM_IPM_InitialApproximation</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Finding out whether the automatic initial approximation is necessary for launching the IPM algorithm.  <a href="#a3a94652d7d7d01f34b4806fa6626a556"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#ad3a6b3872de4edcecd60e6850536cee6">SolveSimplex</a> (long int M, long int N, long int T, double GZ, double EPS, double *UND, double *UP, double *B, double *U, double *AA, long int *STR, long int *NMB)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic simplex method with two sided constraints (c) K.Chudnenko 1992.  <a href="#ad3a6b3872de4edcecd60e6850536cee6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aaa8725bf873dddf69f14a1c8840835fe"></a><!-- doxytag: member="TMulti::SPOS" ref="aaa8725bf873dddf69f14a1c8840835fe" args="(double *P, long int STR[], long int NMB[], long int J, long int M, double AA[])" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#aaa8725bf873dddf69f14a1c8840835fe">SPOS</a> (double *P, long int STR[], long int NMB[], long int J, long int M, double AA[])</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic simplex method with two sided constraints (c) K.Chudnenko 1992 SPOS function. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac0b3e32d2e7bb968c35153d7b7b1e8d0"></a><!-- doxytag: member="TMulti::START" ref="ac0b3e32d2e7bb968c35153d7b7b1e8d0" args="(long int T, long int *ITER, long int M, long int N, long int NMB[], double GZ, double EPS, long int STR[], long int *BASE, double B[], double UND[], double UP[], double AA[], double *A, double *Q)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#ac0b3e32d2e7bb968c35153d7b7b1e8d0">START</a> (long int T, long int *ITER, long int M, long int N, long int NMB[], double GZ, double EPS, long int STR[], long int *BASE, double B[], double UND[], double UP[], double AA[], double *A, double *Q)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic simplex method with two sided constraints (c) K.Chudnenko 1992 START function. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a76d53d3d6402e7d867b0efef9be42012"></a><!-- doxytag: member="TMulti::NEW" ref="a76d53d3d6402e7d867b0efef9be42012" args="(long int *OPT, long int N, long int M, double EPS, double *LEVEL, long int *J0, long int *Z, long int STR[], long int NMB[], double UP[], double AA[], double *A)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a76d53d3d6402e7d867b0efef9be42012">NEW</a> (long int *OPT, long int N, long int M, double EPS, double *LEVEL, long int *J0, long int *Z, long int STR[], long int NMB[], double UP[], double AA[], double *A)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic simplex method with two sided constraints (c) K.Chudnenko 1992 NEW function. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5aecd8a733b6b7532e8dd06d5af41812"></a><!-- doxytag: member="TMulti::WORK" ref="a5aecd8a733b6b7532e8dd06d5af41812" args="(double GZ, double EPS, long int *I0, long int *J0, long int *Z, long int *ITER, long int M, long int STR[], long int NMB[], double AA[], long int BASE[], long int *UNO, double UP[], double *A, double Q[])" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a5aecd8a733b6b7532e8dd06d5af41812">WORK</a> (double GZ, double EPS, long int *I0, long int *J0, long int *Z, long int *ITER, long int M, long int STR[], long int NMB[], double AA[], long int BASE[], long int *UNO, double UP[], double *A, double Q[])</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic simplex method with two sided constraints (c) K.Chudnenko 1992 WORK function. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aeab17f98c467064d425261e1a3d67112"></a><!-- doxytag: member="TMulti::FIN" ref="aeab17f98c467064d425261e1a3d67112" args="(double EPS, long int M, long int N, long int STR[], long int NMB[], long int BASE[], double UND[], double UP[], double U[], double AA[], double *A, double Q[], long int *ITER)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#aeab17f98c467064d425261e1a3d67112">FIN</a> (double EPS, long int M, long int N, long int STR[], long int NMB[], long int BASE[], double UND[], double UP[], double U[], double AA[], double *A, double Q[], long int *ITER)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic simplex method with two sided constraints (c) K.Chudnenko 1992 FIN function. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adf9aeb3275209d3f8b06c887419ce192"></a><!-- doxytag: member="TMulti::GibbsEnergyMinimization" ref="adf9aeb3275209d3f8b06c887419ce192" args="()" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#adf9aeb3275209d3f8b06c887419ce192">GibbsEnergyMinimization</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Call to GEM IPM calculation of equilibrium state in <a class="el" href="struct_m_u_l_t_i.html" title="Contains chemical thermodynamic work data for GEM IPM-3 algorithm.">MULTI</a> (with already scaled GEM problem) <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3343721a032a13c6772a2a92f3fca78b"></a><!-- doxytag: member="TMulti::SystemTotalMolesIC" ref="a3343721a032a13c6772a2a92f3fca78b" args="()" -->
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a3343721a032a13c6772a2a92f3fca78b">SystemTotalMolesIC</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate total IC mole amounts in b vector and return the scaling factor. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6c75310a84257a9e0d2d03cd4e8760fe"></a><!-- doxytag: member="TMulti::ScaleSystemToInternal" ref="a6c75310a84257a9e0d2d03cd4e8760fe" args="(double ScFact)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a6c75310a84257a9e0d2d03cd4e8760fe">ScaleSystemToInternal</a> (double ScFact)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Resizes <a class="el" href="struct_m_u_l_t_i.html" title="Contains chemical thermodynamic work data for GEM IPM-3 algorithm.">MULTI</a> (GEM IPM work structure) data into internally scaled constant mass. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3711a26e9ad1acb2c8f94b9fb25496d1"></a><!-- doxytag: member="TMulti::RescaleSystemFromInternal" ref="a3711a26e9ad1acb2c8f94b9fb25496d1" args="(double ScFact)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a3711a26e9ad1acb2c8f94b9fb25496d1">RescaleSystemFromInternal</a> (double ScFact)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Re-scaling the internal constant-mass <a class="el" href="struct_m_u_l_t_i.html" title="Contains chemical thermodynamic work data for GEM IPM-3 algorithm.">MULTI</a> system definition back to real size. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a484de75940e79934a38bd53072adcb58">MultiConstInit</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup/copy flags and thresholds for numeric modules to <a class="el" href="class_t_multi.html">TMulti</a> structure.  <a href="#a484de75940e79934a38bd53072adcb58"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a7d1123d2f2f13c244eccbe649afa93f9">GEM_IPM_Init</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculation by IPM (internal step initialization)  <a href="#a7d1123d2f2f13c244eccbe649afa93f9"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aacf37532bfac24f09b3157288370b454"></a><!-- doxytag: member="TMulti::sizeFIs" ref="aacf37532bfac24f09b3157288370b454" args="" -->
long int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#aacf37532bfac24f09b3157288370b454">sizeFIs</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">current size of phSolMod <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae9eec930d16ddf1fbebfbd5ec94303be"></a><!-- doxytag: member="TMulti::phSolMod" ref="ae9eec930d16ddf1fbebfbd5ec94303be" args="" -->
<a class="el" href="class_t_sol_mod.html">TSolMod</a> **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#ae9eec930d16ddf1fbebfbd5ec94303be">phSolMod</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">size current FIs - number of multicomponent phases <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a03101790a8247092be57c751d96b9def"></a><!-- doxytag: member="TMulti::nNu" ref="a03101790a8247092be57c751d96b9def" args="" -->
long int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a03101790a8247092be57c751d96b9def">nNu</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">number of ICs in the system <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a59b2cd0f36cf308ebb952457585ab4d1"></a><!-- doxytag: member="TMulti::cnr" ref="a59b2cd0f36cf308ebb952457585ab4d1" args="" -->
long int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a59b2cd0f36cf308ebb952457585ab4d1">cnr</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">current IPM iteration <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aecc2e330a2748abf62d46cc590b47010"></a><!-- doxytag: member="TMulti::nCNud" ref="aecc2e330a2748abf62d46cc590b47010" args="" -->
long int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#aecc2e330a2748abf62d46cc590b47010">nCNud</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">number of IC names for divergent dual chemical potentials <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5dcc1583ca7ab074b3fdceea91c347dd"></a><!-- doxytag: member="TMulti::U_mean" ref="a5dcc1583ca7ab074b3fdceea91c347dd" args="" -->
double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a5dcc1583ca7ab074b3fdceea91c347dd">U_mean</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Cumulative mean dual solution approximation [nNu]. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afc63c0e08adac48e7a8122710a43b329"></a><!-- doxytag: member="TMulti::U_M2" ref="afc63c0e08adac48e7a8122710a43b329" args="" -->
double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#afc63c0e08adac48e7a8122710a43b329">U_M2</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Cumulative sum of squares [nNu]. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7532d01a844b74f3167e1c6c503951d1"></a><!-- doxytag: member="TMulti::U_CVo" ref="a7532d01a844b74f3167e1c6c503951d1" args="" -->
double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a7532d01a844b74f3167e1c6c503951d1">U_CVo</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Cumulative Coefficient of Variation for dual solution approximation r-1 [nNu]. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad4205de4df0100c67341c75fe58c0e4d"></a><!-- doxytag: member="TMulti::U_CV" ref="ad4205de4df0100c67341c75fe58c0e4d" args="" -->
double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#ad4205de4df0100c67341c75fe58c0e4d">U_CV</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Cumulative Coefficient of Variation for r-th dual solution approximation [nNu]. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9e84ba3f7a80e683d700638284add70b"></a><!-- doxytag: member="TMulti::ICNud" ref="a9e84ba3f7a80e683d700638284add70b" args="" -->
long int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a9e84ba3f7a80e683d700638284add70b">ICNud</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">List of IC indexes for divergent dual chemical potentials [nNu]. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aed664fc2032f455001db9638a90f954c"></a><!-- doxytag: member="TMulti::PAalp_" ref="aed664fc2032f455001db9638a90f954c" args="" -->
char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#aed664fc2032f455001db9638a90f954c">PAalp_</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag for using (+) or ignoring (-) specific surface areas of phases. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a05127b7a6afcd2e6f96cbc72f1582058"></a><!-- doxytag: member="TMulti::PSigm_" ref="a05127b7a6afcd2e6f96cbc72f1582058" args="" -->
char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_multi.html#a05127b7a6afcd2e6f96cbc72f1582058">PSigm_</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag for using (+) or ignoring (-) specific surface free energies. <br/></td></tr>
</table>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a4f5cd5279e3e52c40dae42721883e0ea"></a><!-- doxytag: member="TMulti::AutoInitialApproximation" ref="a4f5cd5279e3e52c40dae42721883e0ea" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_t_multi.html#a4f5cd5279e3e52c40dae42721883e0ea">TMulti::AutoInitialApproximation</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculation of LPP-based automatic initial approximation of the primal vector x. </p>
<p>Use the modified simplex method with two-side constraints on x </p>

</div>
</div>
<a class="anchor" id="a97568fb4779b7b69af4ca16bce51864e"></a><!-- doxytag: member="TMulti::CalculateActivityCoefficients" ref="a97568fb4779b7b69af4ca16bce51864e" args="(long int LinkMode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long int <a class="el" href="class_t_multi.html#a97568fb4779b7b69af4ca16bce51864e">TMulti::CalculateActivityCoefficients</a> </td>
          <td>(</td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>LinkMode</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Main call point for calculation of DC activity coefficients (lnGam vector) formerly GammaCalc(). </p>
<p>Controls various built-in models, as well as generic Phase script calculation LinkMode is a parameter indicating the status of Gamma calculations: LINK_TP_MODE - calculation of equations depending on TP only; LINK_UX_MODE - calculation of equations depending on current IPM approximation of the equilibrium state; LINK_PP_MODE - calculation of integral phase properties after GEMIPM has converged needs to be implemented </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>status code (0 if o.k., non-zero values if there were problems with surface complexation models) </dd></dl>

</div>
</div>
<a class="anchor" id="a5da155d74ac7092b36347caeec4f50a3"></a><!-- doxytag: member="TMulti::CalculateConcentrations" ref="a5da155d74ac7092b36347caeec4f50a3" args="(double X[], double XF[], double XFA[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_t_multi.html#a5da155d74ac7092b36347caeec4f50a3">TMulti::CalculateConcentrations</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>X</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>XF</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>XFA</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculation of derived values (concentrations etc.) on IPM iteration from X,XF, and XFA vectors. </p>
<p>Also calculates pH, pe, Eh </p>
<p>!!!! </p>

</div>
</div>
<a class="anchor" id="a7e0bef8039395c1a3a44d96026e210ed"></a><!-- doxytag: member="TMulti::CalculateConcentrationsInPhase" ref="a7e0bef8039395c1a3a44d96026e210ed" args="(double X[], double XF[], double XFA[], double Factor, double MMC, double Dsur, long int jb, long int je, long int k)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_t_multi.html#a7e0bef8039395c1a3a44d96026e210ed">TMulti::CalculateConcentrationsInPhase</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>X</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>XF</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>XFA</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Factor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>MMC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Dsur</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>jb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>je</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculation of dual chemical potentials, activities, and primal concentrations for DCs (indexed jb to je) in a k-th phase. </p>

</div>
</div>
<a class="anchor" id="a831477262b912255cb37321212657962"></a><!-- doxytag: member="TMulti::CalculateEquilibriumState" ref="a831477262b912255cb37321212657962" args="(long int typeMin, long int &amp;NumIterFIA, long int &amp;NumIterIPM)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="class_t_multi.html#a831477262b912255cb37321212657962">TMulti::CalculateEquilibriumState</a> </td>
          <td>(</td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>typeMin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int &amp;&#160;</td>
          <td class="paramname"><em>NumIterFIA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int &amp;&#160;</td>
          <td class="paramname"><em>NumIterIPM</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Main call to GEM IPM calculation of equilibrium state in <a class="el" href="struct_m_u_l_t_i.html" title="Contains chemical thermodynamic work data for GEM IPM-3 algorithm.">MULTI</a> (with internal re-scaling of the system). </p>

</div>
</div>
<a class="anchor" id="adeccd4c29eb9e9ff3a51e202ec36e145"></a><!-- doxytag: member="TMulti::Check_uDD" ref="adeccd4c29eb9e9ff3a51e202ec36e145" args="(long int mode, double DivTol, bool trace=false)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long int <a class="el" href="class_t_multi.html#adeccd4c29eb9e9ff3a51e202ec36e145">TMulti::Check_uDD</a> </td>
          <td>(</td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>DivTol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>trace</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Checking for divergence in coef.variation of dual solution approximation. </p>
<p>Compares with CV value tolerance (mode = 0) or with CV increase tolerance (mode = 1) </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 if no divergence has been detected &gt;0 - number of diverging dual chemical potentials (their IC names are collected in the ICNud list) </dd></dl>

</div>
</div>
<a class="anchor" id="aaebbf6d96e7cf89e432688a584819253"></a><!-- doxytag: member="TMulti::CheckMassBalanceResiduals" ref="aaebbf6d96e7cf89e432688a584819253" args="(double *Y)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long int <a class="el" href="class_t_multi.html#aaebbf6d96e7cf89e432688a584819253">TMulti::CheckMassBalanceResiduals</a> </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Y</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Diagnostics for a severe break of mass balance (abs.moles) after GEM IPM <a class="el" href="class_t_multi.html#ab0987119ad690a52fb5ee10922f19a8d" title="Checking Karpov phase stability criteria Fa for phases and DCs.">PhaseSelect()</a>. </p>
<p>When pm.X is passed as parameter </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>-1 (Ok) or index of the first IC for which the balance is broken </dd></dl>

</div>
</div>
<a class="anchor" id="a365fdf25b48d55278da79c12e339eeb3"></a><!-- doxytag: member="TMulti::ConvertGj_toUniformStandardState" ref="a365fdf25b48d55278da79c12e339eeb3" args="(double g0, long int j, long int k)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="class_t_multi.html#a365fdf25b48d55278da79c12e339eeb3">TMulti::ConvertGj_toUniformStandardState</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>g0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Conversion of g(T,P) value for DCs into the uniform cj scale. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">k</td><td>- index of phase, </td></tr>
    <tr><td class="paramname">j</td><td>- index DC in phase </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>if error code, returns 777777777. </dd></dl>

</div>
</div>
<a class="anchor" id="ae51cf1a690d7c2b1ea5498a0b2373bc4"></a><!-- doxytag: member="TMulti::DC_GibbsEnergyContribution" ref="ae51cf1a690d7c2b1ea5498a0b2373bc4" args="(double G, double x, double logXF, double logXw, char DCCW)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="class_t_multi.html#ae51cf1a690d7c2b1ea5498a0b2373bc4">TMulti::DC_GibbsEnergyContribution</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>logXF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>logXw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>DCCW</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculation of a species contribution to the total Gibbs energy G(X) of the system. </p>
<p>On error returns +7777777. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">G</td><td>gT0+gEx </td></tr>
    <tr><td class="paramname">x</td><td>x - mole amount of species </td></tr>
    <tr><td class="paramname">logXF</td><td>ln Xa - mole amount of phase </td></tr>
    <tr><td class="paramname">logXw</td><td>ln Xv - mole amount of the solvent/sorbent </td></tr>
    <tr><td class="paramname">DCCW</td><td>generalized species class code </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a173495b5c98735bd69fd9b91f6ef066c"></a><!-- doxytag: member="TMulti::DC_PrimalChemicalPotential" ref="a173495b5c98735bd69fd9b91f6ef066c" args="(double G, double logY, double logYF, double asTail, double logYw, char DCCW)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="class_t_multi.html#a173495b5c98735bd69fd9b91f6ef066c">TMulti::DC_PrimalChemicalPotential</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>logY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>logYF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>asTail</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>logYw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>DCCW</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculation of DC primal chemical potential F. </p>
<p>From moles of DC Y[], total moles of phase YF[] and DC partial molar Gibbs energy gT (obtained from pm.G[]) which includes activity coefficient terms. On error returns F = +7777777. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">G</td><td>gT0+gEx </td></tr>
    <tr><td class="paramname">logY</td><td>ln x </td></tr>
    <tr><td class="paramname">logYF</td><td>ln Xa </td></tr>
    <tr><td class="paramname">asTail</td><td>asymmetry non-log term or 0 for symmetric phases </td></tr>
    <tr><td class="paramname">logYw</td><td>ln Xv </td></tr>
    <tr><td class="paramname">DCCW</td><td>generalized species class code </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a852f7489d1ea8698cc4ef1363f0e5e38"></a><!-- doxytag: member="TMulti::DC_PrimalChemicalPotentialUpdate" ref="a852f7489d1ea8698cc4ef1363f0e5e38" args="(long int j, long int k)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="class_t_multi.html#a852f7489d1ea8698cc4ef1363f0e5e38">TMulti::DC_PrimalChemicalPotentialUpdate</a> </td>
          <td>(</td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Corrections to primal chemical potentials F0[j] of j-th species in k-th phase among IPM main iterations. </p>
<p>Returns double value of corrected chem. potential. If error, returns +7777777 J/mole. </p>
<p>!!!!</p>
<p>!!!! </p>

</div>
</div>
<a class="anchor" id="aaff2948482e2bfe7979e0c187611793e"></a><!-- doxytag: member="TMulti::DC_RaiseZeroedOff" ref="aaff2948482e2bfe7979e0c187611793e" args="(long int jStart, long int jEnd, long int k=&#45;1L)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_t_multi.html#aaff2948482e2bfe7979e0c187611793e">TMulti::DC_RaiseZeroedOff</a> </td>
          <td>(</td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>jStart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>jEnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>k</em> = <code>-1L</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Inserting minor quantities of DC which were zeroed off by <a class="el" href="class_t_multi.html#ad3a6b3872de4edcecd60e6850536cee6" title="Generic simplex method with two sided constraints (c) K.Chudnenko 1992.">SolveSimplex()</a>. </p>
<p>Important for the automatic initial approximation with solution phases (k = -1) or inserting a solution phase after <a class="el" href="class_t_multi.html#ab0987119ad690a52fb5ee10922f19a8d" title="Checking Karpov phase stability criteria Fa for phases and DCs.">PhaseSelect()</a> (k &gt;= 0) </p>

</div>
</div>
<a class="anchor" id="a0245f972e785fcb412ab228d6194b1fa"></a><!-- doxytag: member="TMulti::DikinsCriterion" ref="a0245f972e785fcb412ab228d6194b1fa" args="(long int N, bool initAppr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="class_t_multi.html#a0245f972e785fcb412ab228d6194b1fa">TMulti::DikinsCriterion</a> </td>
          <td>(</td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>initAppr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculation of MU values (in the vector of direction of descent) and Dikin criterion. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">initAppr</td><td>- use in <a class="el" href="class_t_multi.html#aa21ef549ee562d688a3aa1e84f2f8c9a" title="Calculation of a feasible IPM approximation, refinement of the mass balance.">MassBalanceRefinement()</a> (true) or main iteration of IPM (false) </td></tr>
    <tr><td class="paramname">N</td><td>- dimension of the matrix R (number of equations) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a6b8d1a27f84d3f707fa6d1cba1c3c2d5"></a><!-- doxytag: member="TMulti::GEM_IPM" ref="a6b8d1a27f84d3f707fa6d1cba1c3c2d5" args="(long int rLoop)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_t_multi.html#a6b8d1a27f84d3f707fa6d1cba1c3c2d5">TMulti::GEM_IPM</a> </td>
          <td>(</td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>rLoop</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Main sequence of GEM IPM algorithm implementation. </p>
<p>Main place for implementation of diagnostics and setup of IPM precision and convergence rLoop is the index of the primal solution refinement loop (for tracing) or -1 if this is main GEM_IPM call </p>

</div>
</div>
<a class="anchor" id="a7d1123d2f2f13c244eccbe649afa93f9"></a><!-- doxytag: member="TMulti::GEM_IPM_Init" ref="a7d1123d2f2f13c244eccbe649afa93f9" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_t_multi.html#a7d1123d2f2f13c244eccbe649afa93f9">TMulti::GEM_IPM_Init</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculation by IPM (internal step initialization) </p>
<p>line must be tested !pm.FIs </p>

</div>
</div>
<a class="anchor" id="a3a94652d7d7d01f34b4806fa6626a556"></a><!-- doxytag: member="TMulti::GEM_IPM_InitialApproximation" ref="a3a94652d7d7d01f34b4806fa6626a556" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_t_multi.html#a3a94652d7d7d01f34b4806fa6626a556">TMulti::GEM_IPM_InitialApproximation</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Finding out whether the automatic initial approximation is necessary for launching the IPM algorithm. </p>
<p>Uses a modified simplex method with two-side constraints (Karpov ea 1997) </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>false - OK for IPM true - OK solved (pure phases only in the system) </dd></dl>

</div>
</div>
<a class="anchor" id="a787e4e93758b94959ea8c624664569eb"></a><!-- doxytag: member="TMulti::GouyChapman" ref="a787e4e93758b94959ea8c624664569eb" args="(long int jb, long int je, long int k)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long int <a class="el" href="class_t_multi.html#a787e4e93758b94959ea8c624664569eb">TMulti::GouyChapman</a> </td>
          <td>(</td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>jb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>je</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculation of the surface potential pm[q].XpsiD[k] on diffuse. </p>
<p>layer plane on k-th sorption phase. From total charge pm.Xeta[k] ( in moles ) using Gouy-Chapman equation. Strictly valid at PSI &lt; 30 mV. Modified by DAK 5 Jan 2000 to add a Basic Stern EDL model. Added 13.03.2008 by DK: returns int value showing (if not 0) that some extreme values were reached for charge densities or electric potentials (for detecting bad PIA), 0 otherwise </p>

</div>
</div>
<a class="anchor" id="a3042adac38b4156709da3e6928dda984"></a><!-- doxytag: member="TMulti::GX" ref="a3042adac38b4156709da3e6928dda984" args="(double LM)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="class_t_multi.html#a3042adac38b4156709da3e6928dda984">TMulti::GX</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LM</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculation of the total Gibbs energy of the system G(X) and copying of Y, YF vectors into X,XF, respectively. </p>
<p>Parameter LM is the IPM step size for calculation of new quantities of all species (vector X[]) using the direction of descent (MU[] vector). If LM == 0, this function just copies vector Y[] into X[]. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>of G(X) in moles. </dd></dl>

</div>
</div>
<a class="anchor" id="af8cd7213884c0420eb1e86b850c06254"></a><!-- doxytag: member="TMulti::HelmholtzEnergy" ref="af8cd7213884c0420eb1e86b850c06254" args="(double x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="class_t_multi.html#af8cd7213884c0420eb1e86b850c06254">TMulti::HelmholtzEnergy</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calls to minimization of other system potentials - HelmholtzEnergy. </p>
<p>Calc function for Method of golden section (only in GEMS ). </p>

</div>
</div>
<a class="anchor" id="ae0ce862b92fb59c63df3badc9a0c0eb1"></a><!-- doxytag: member="TMulti::InteriorPointsMethod" ref="ae0ce862b92fb59c63df3badc9a0c0eb1" args="(long int &amp;status, long int rLoop)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long int <a class="el" href="class_t_multi.html#ae0ce862b92fb59c63df3badc9a0c0eb1">TMulti::InteriorPointsMethod</a> </td>
          <td>(</td>
          <td class="paramtype">long int &amp;&#160;</td>
          <td class="paramname"><em>status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>rLoop</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculation of chemical equilibrium using the Interior Points Method algorithm (see Karpov et al., 1997, p. </p>
<p>785-786) GEM IPM </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>0, if converged; 1, in the case of R matrix degeneration 2, (more than max iteration) - no convergence or user's interruption 3, <a class="el" href="class_t_multi.html#a97568fb4779b7b69af4ca16bce51864e" title="Main call point for calculation of DC activity coefficients (lnGam vector) formerly GammaCalc()...">CalculateActivityCoefficients()</a> returns bad (non-zero) status 4, Mass balance broken in DualTH (Mol_u) 5, Divergence in dual solution u vector has been detected </dd></dl>

</div>
</div>
<a class="anchor" id="a12af02446fdc8df715cc57f4a348415a"></a><!-- doxytag: member="TMulti::InternalEnergy" ref="a12af02446fdc8df715cc57f4a348415a" args="(double TC, double P)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="class_t_multi.html#a12af02446fdc8df715cc57f4a348415a">TMulti::InternalEnergy</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>TC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>P</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calls to minimization of other system potentials - InternalEnergy. </p>
<p>Calc function for Method of golden section (only in GEMS ). </p>

</div>
</div>
<a class="anchor" id="a82af3be3535af9157e8acf16b7ebadb2"></a><!-- doxytag: member="TMulti::MakeAndSolveSystemOfLinearEquations" ref="a82af3be3535af9157e8acf16b7ebadb2" args="(long int N, bool initAppr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long int <a class="el" href="class_t_multi.html#a82af3be3535af9157e8acf16b7ebadb2">TMulti::MakeAndSolveSystemOfLinearEquations</a> </td>
          <td>(</td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>initAppr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Make and Solve a system of linear equations to find the dual vector approximation using a method of Cholesky Decomposition. </p>
<p>Good if a square matrix R happens to be symmetric and positive defined. If Cholesky Decomposition does not solve the problem, an attempt is done to solve the SLE using method of LU Decomposition (A = L*U , L is lower triangular ( has elements only on the diagonal and below ) U is is upper triangular ( has elements only on the diagonal and above)) </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">initAppr</td><td>- Inital approximation point(true) or iteration of IPM (false) N - dimension of the matrix R (number of equations) </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 - solved OK; 1 - no solution, degenerated or inconsistent system </dd></dl>

</div>
</div>
<a class="anchor" id="aa21ef549ee562d688a3aa1e84f2f8c9a"></a><!-- doxytag: member="TMulti::MassBalanceRefinement" ref="aa21ef549ee562d688a3aa1e84f2f8c9a" args="(long int WhereCalledFrom)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long int <a class="el" href="class_t_multi.html#aa21ef549ee562d688a3aa1e84f2f8c9a">TMulti::MassBalanceRefinement</a> </td>
          <td>(</td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>WhereCalledFrom</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculation of a feasible IPM approximation, refinement of the mass balance. </p>
<p>Algorithm: see Karpov, Chudnenko, Kulik 1997 Amer.J.Sci. vol 297 p. 798-799 (Appendix B) Control: MaxResidualRatio, 0 (deactivated), &gt; DHBM and &lt; 1 - accuracy for "trace" independent components (max residual for i should not exceed B[i]*MaxResidualRatio) </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">WhereCalledFrom,0</td><td>- at entry after automatic LPP-based IA; 1 - at entry in SIA (start without <a class="el" href="class_t_multi.html#ad3a6b3872de4edcecd60e6850536cee6" title="Generic simplex method with two sided constraints (c) K.Chudnenko 1992.">SolveSimplex()</a> 2 - after post-IPM cleanup 3 - additional (after PhaseSelection) </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 - OK, 1 - no SLE colution at the specified precision pa.p.DHB 2 - used up more than pa.p.DP iterations 3 - too small step length (&lt; 1e-6), no descent possible 4 - error in Initial mass balance residuals (debugging) 5 - error in <a class="el" href="class_t_multi.html#ad6bec948f22581dfdad6485d813487e9" title="Adjustment of primal approximation according to kinetic constraints.">MetastabilityLagrangeMultiplier()</a> (debugging) </dd></dl>

</div>
</div>
<a class="anchor" id="ac29d91460e0a7fbd4ea989352348af45"></a><!-- doxytag: member="TMulti::MassBalanceResiduals" ref="ac29d91460e0a7fbd4ea989352348af45" args="(long int N, long int L, double *A, double *Y, double *B, double *C)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_t_multi.html#ac29d91460e0a7fbd4ea989352348af45">TMulti::MassBalanceResiduals</a> </td>
          <td>(</td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>C</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculation of mass-balance residuals in GEM IPM CSD. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">N</td><td>- number of IC in IPM problem </td></tr>
    <tr><td class="paramname">L</td><td>- number of DC in IPM problem </td></tr>
    <tr><td class="paramname">A</td><td>- DC stoichiometry matrix (LxN) </td></tr>
    <tr><td class="paramname">Y</td><td>- moles DC quantities in IPM solution (L) </td></tr>
    <tr><td class="paramname">B</td><td>- Input bulk chem. compos. (N) </td></tr>
    <tr><td class="paramname">C</td><td>- mass balance residuals (N) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a484de75940e79934a38bd53072adcb58"></a><!-- doxytag: member="TMulti::MultiConstInit" ref="a484de75940e79934a38bd53072adcb58" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_t_multi.html#a484de75940e79934a38bd53072adcb58">TMulti::MultiConstInit</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Setup/copy flags and thresholds for numeric modules to <a class="el" href="class_t_multi.html">TMulti</a> structure. </p>
<p>Do it before calculations </p>

</div>
</div>
<a class="anchor" id="a1eae05db545806122b7a640d64c942a5"></a><!-- doxytag: member="TMulti::OptimizeStepSize" ref="a1eae05db545806122b7a640d64c942a5" args="(double LM)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="class_t_multi.html#a1eae05db545806122b7a640d64c942a5">TMulti::OptimizeStepSize</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LM</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Interior Points Method subroutine for unconditional optimization of the descent step length on the interval 0 to LM. </p>
<p>uses the "Golden Section" algorithm Formerly called LMD() </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>optimal value of LM which provides the largest possible monotonous decrease in G(X) </dd></dl>

</div>
</div>
<a class="anchor" id="ab0987119ad690a52fb5ee10922f19a8d"></a><!-- doxytag: member="TMulti::PhaseSelect" ref="ab0987119ad690a52fb5ee10922f19a8d" args="(long int &amp;k_miss, long int &amp;k_unst, long int rLoop)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long int <a class="el" href="class_t_multi.html#ab0987119ad690a52fb5ee10922f19a8d">TMulti::PhaseSelect</a> </td>
          <td>(</td>
          <td class="paramtype">long int &amp;&#160;</td>
          <td class="paramname"><em>kfr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int &amp;&#160;</td>
          <td class="paramname"><em>kur</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>RaiseStatus</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Checking Karpov phase stability criteria Fa for phases and DCs. </p>
<p>Using Selekt2() algorithm by Karpov &amp; Chudnenko (1989) modified by DK in 1995 and in 2007, 2012 RaiseStatus: if 1 then zeroed-off DCs are raised to constant in solution phases present in eq state, otherwise (0) this is skipped assuming that SpeciationCleanup will be done. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>0, if some phases were inserted and a new IPM loop is needed (up to 3 loops possible); 1, if the IPM solution is final and consistent, no phases were inserted -1, if the IPM solution is inconsistent after 3 Selekt2() loops In this case, the index of most problematic phase is passed through kfr or kur parameter (parameter value -1 means that no problematic phases were found) </dd></dl>

</div>
</div>
<a class="anchor" id="a1ff7224c7dcfd5aa2d6c6792af6039d8"></a><!-- doxytag: member="TMulti::PhaseSelectionSpeciationCleanup" ref="a1ff7224c7dcfd5aa2d6c6792af6039d8" args="(long int &amp;k_miss, long int &amp;k_unst, long int rLoop)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long int <a class="el" href="class_t_multi.html#a1ff7224c7dcfd5aa2d6c6792af6039d8">TMulti::PhaseSelectionSpeciationCleanup</a> </td>
          <td>(</td>
          <td class="paramtype">long int &amp;&#160;</td>
          <td class="paramname"><em>kfr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int &amp;&#160;</td>
          <td class="paramname"><em>kur</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>CleanupStatus</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>New simplified PSSC() algorithm DK 01.05.2010. </p>
<p>PhaseSelection() part only looks for phases to be inserted, also checks if some solution phases are unstable. Removal of unstable phases is done afterwards in SpeciationCleanup subroutine if CleanupStatus is not zero. As phase stability criterion, uses (log) phase stability (saturation) index computed from DualTh activities of components and activity coefficients </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>1L if Ok; 0 if one more IPM loop should be done; -1L if 3 loops did not fix the problem </dd></dl>

</div>
</div>
<a class="anchor" id="a4bd5e994af5113e2be07d6540a1f6cde"></a><!-- doxytag: member="TMulti::PhaseSpecificGamma" ref="a4bd5e994af5113e2be07d6540a1f6cde" args="(long int j, long int jb, long int je, long int k, long int DirFlag=0L)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="class_t_multi.html#a4bd5e994af5113e2be07d6540a1f6cde">TMulti::PhaseSpecificGamma</a> </td>
          <td>(</td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>jb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>je</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>DirFlag</em> = <code>0L</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Function for converting internal lnGam[j] value into an external (phase-scale-specific) Gamma[j] if DirFlag = 0 or external into internal value if DirFlag = 1. </p>
<p>Returns the respectively corrected external gamma activity coefficient or internal lnGam Returns trivial values (lnGam = 0 or Gamma = 1) when the respective component amount is zero (X[j] == 0) (is this a correct policy for zeroed-off components?) </p>

</div>
</div>
<a class="anchor" id="aa633a2ab673b0eeea4c36ac10ac4f86d"></a><!-- doxytag: member="TMulti::Set_DC_limits" ref="aa633a2ab673b0eeea4c36ac10ac4f86d" args="(long int Mode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_t_multi.html#aa633a2ab673b0eeea4c36ac10ac4f86d">TMulti::Set_DC_limits</a> </td>
          <td>(</td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>Mode</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This procedure sets kinetic constraints according to a given concentration units. </p>

</div>
</div>
<a class="anchor" id="ad47aa9e7ee1a16f552b1f5c079bc61f4"></a><!-- doxytag: member="TMulti::SetSmoothingFactor" ref="ad47aa9e7ee1a16f552b1f5c079bc61f4" args="(long int mode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_t_multi.html#ad47aa9e7ee1a16f552b1f5c079bc61f4">TMulti::SetSmoothingFactor</a> </td>
          <td>(</td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>mode</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>New correction of smoothing factor for highly non-ideal systems. </p>
<p>Smoothing function choice: AG &gt;= 0.0001 and DGC &gt; -0.0001: old f(IT) AG &gt;= 0.0001 and DGC &lt;= -0.0001: new f(1/IT) AG &lt;= -0.0001 and DGC &lt;= -0.0001: new f(1/CD) </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">mode</td><td>0 - taking single log(CD) value for calculation of smoothing factor SF; 1, 2, ... taking log(CD) average from the moving window of length mode (up to 5 consecutive values) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="acee19c49cf66d2be5bb86db0883c40cd"></a><!-- doxytag: member="TMulti::SolModCreate" ref="acee19c49cf66d2be5bb86db0883c40cd" args="(long int jb, long int jmb, long int jsb, long int jpb, long int jdb, long int k, long int ipb, char ModCode, char MixCode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_t_multi.html#acee19c49cf66d2be5bb86db0883c40cd">TMulti::SolModCreate</a> </td>
          <td>(</td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>jb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>jmb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>jsb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>jpb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>jdb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>ipb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>ModCode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>MixCode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Wrapper calls for creating multi-component mixing models for phases using <a class="el" href="class_t_sol_mod.html">TSolMod</a> class. </p>
<p>Now including multi-site ideal and scripted models </p>

</div>
</div>
<a class="anchor" id="ad3a6b3872de4edcecd60e6850536cee6"></a><!-- doxytag: member="TMulti::SolveSimplex" ref="ad3a6b3872de4edcecd60e6850536cee6" args="(long int M, long int N, long int T, double GZ, double EPS, double *UND, double *UP, double *B, double *U, double *AA, long int *STR, long int *NMB)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_t_multi.html#ad3a6b3872de4edcecd60e6850536cee6">TMulti::SolveSimplex</a> </td>
          <td>(</td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>GZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>EPS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>UND</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>UP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>U</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>AA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int *&#160;</td>
          <td class="paramname"><em>STR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int *&#160;</td>
          <td class="paramname"><em>NMB</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Generic simplex method with two sided constraints (c) K.Chudnenko 1992. </p>
<p>Main function </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">M</td><td>- number of independent components </td></tr>
    <tr><td class="paramname">N</td><td>- number of unknowns </td></tr>
    <tr><td class="paramname">T</td><td>- dimension of a work vector AA[] containing all non-zero values of vector GT[] and A[][] matrix (over lines) </td></tr>
    <tr><td class="paramname">GZ</td><td>- Limiting value of the unknown </td></tr>
    <tr><td class="paramname">EPS</td><td>- precision (convergence) criterion (default 1e-9) </td></tr>
    <tr><td class="paramname">UND</td><td>- vector of lower constraints to unknowns </td></tr>
    <tr><td class="paramname">UP</td><td>- input vector of upper constraints to unknowns; output vector of unknowns (simplex solution) (N+M) </td></tr>
    <tr><td class="paramname">B</td><td>- M input values of independent components (bulk composition) </td></tr>
    <tr><td class="paramname">U</td><td>- output vector of the dual solution (M) </td></tr>
    <tr><td class="paramname">AA</td><td>- work array (T) </td></tr>
    <tr><td class="paramname">STR</td><td>- markup vector of values in AA array (T) </td></tr>
    <tr><td class="paramname">NMB</td><td>- indices of values in AA </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 if OK; 1 if inconsistent input constraints; -1 if memory allocation error; </dd></dl>

</div>
</div>
<a class="anchor" id="ad8826f14b647c15202974c46a9cf4e1f"></a><!-- doxytag: member="TMulti::SpeciationCleanup" ref="ad8826f14b647c15202974c46a9cf4e1f" args="(double AmountThreshold, double ChemPotDiffCutoff)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long int <a class="el" href="class_t_multi.html#ad8826f14b647c15202974c46a9cf4e1f">TMulti::SpeciationCleanup</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>AmountCorrectionThreshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>MjuDiffCutoff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Speciation cleanup subroutine if CleanupStatus is not zero. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">AmountCorrectionThreshold</td><td>- the maximum DC amount correction that can be cleaned ( 1e-5 ) </td></tr>
    <tr><td class="paramname">MjuDiffCutoff</td><td>- normalized chem.pot. difference threshold (dMu = ln a - ln a,dual) </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 if no subsequent refinement of mass balance is needed; 1 if species amounts were cleaned up to more than requested overall mass balance accuracy -1 if cleanup has been done and the degeneration of the chemical system occurred 2 solution is seriously distorted and full PhaseSelect3() loop is necessary </dd></dl>

</div>
</div>
<a class="anchor" id="ac7ddcf02e7b9c26fdc310738c7450d12"></a><!-- doxytag: member="TMulti::StepSizeEstimate" ref="ac7ddcf02e7b9c26fdc310738c7450d12" args="(bool initAppr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="class_t_multi.html#ac7ddcf02e7b9c26fdc310738c7450d12">TMulti::StepSizeEstimate</a> </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>initAppr</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Estimation of the descent step length LM. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">initAppr</td><td>- MBR() (true) or iteration of IPM (false) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ab41f91ff6ae502782679542f01818b63"></a><!-- doxytag: member="TMulti::SurfaceActivityCoeff" ref="ab41f91ff6ae502782679542f01818b63" args="(long int jb, long int je, long int jpb, long int jdb, long int k)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long int <a class="el" href="class_t_multi.html#ab41f91ff6ae502782679542f01818b63">TMulti::SurfaceActivityCoeff</a> </td>
          <td>(</td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>jb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>je</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>jpb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>jdb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculation of new surface activity coefficient terms SACT (Kulik, 2004) </p>
<p>Revised by KD in April 2004 (PSI) to introduce new activity coefficient terms SACT rigorously derived from Langmuir and QCA isotherms (Kulik 2006, Radiochimica Acta). SACT are placed into pm.lnGam[j], as other activity coefficients except relative surface potentials (Coulombic terms) kept separately. Old (obsolete) SAT calculations (Kulik 2000, 2002) are retained. pm.lnSAC[*][3] vector is now used to keep original DUL[j] to restore them after IPM-2 refinements for surface complexes. Added 13.03.2008 by DK: returns int value showing (if true) that some extreme values were obtained for some SACTs, 0 otherwise (for detecting bad PIA) </p>

</div>
</div>
<a class="anchor" id="ae55b4573ef1259a75c30a21cd73ccee9"></a><!-- doxytag: member="TMulti::XmaxSAT_IPM2" ref="ae55b4573ef1259a75c30a21cd73ccee9" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_t_multi.html#ae55b4573ef1259a75c30a21cd73ccee9">TMulti::XmaxSAT_IPM2</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculation of max.moles of surface species for SACT stabilization to improve IPM-2 convergence at high SACT values. </p>
<p>xj0 values are placed as upper kinetic constraints </p>
<p>!!!!!</p>
<p>!!!!!</p>
<p>!!!!! </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/parallels/DevGEMS/trunk/standalone/GEMS3K/<a class="el" href="ms__multi_8h_source.html">ms_multi.h</a></li>
<li>/home/parallels/DevGEMS/trunk/standalone/GEMS3K/<a class="el" href="ipm__chemical_8cpp.html">ipm_chemical.cpp</a></li>
<li>/home/parallels/DevGEMS/trunk/standalone/GEMS3K/<a class="el" href="ipm__chemical2_8cpp.html">ipm_chemical2.cpp</a></li>
<li>/home/parallels/DevGEMS/trunk/standalone/GEMS3K/<a class="el" href="ipm__chemical3_8cpp.html">ipm_chemical3.cpp</a></li>
<li>/home/parallels/DevGEMS/trunk/standalone/GEMS3K/<a class="el" href="ipm__main_8cpp.html">ipm_main.cpp</a></li>
<li>/home/parallels/DevGEMS/trunk/standalone/GEMS3K/<a class="el" href="ipm__simplex_8cpp.html">ipm_simplex.cpp</a></li>
<li>/home/parallels/DevGEMS/trunk/standalone/GEMS3K/<a class="el" href="ms__multi__file_8cpp.html">ms_multi_file.cpp</a></li>
<li>/home/parallels/DevGEMS/trunk/standalone/GEMS3K/<a class="el" href="ms__multi__format_8cpp.html">ms_multi_format.cpp</a></li>
<li>/home/parallels/DevGEMS/trunk/standalone/GEMS3K/<a class="el" href="ms__param_8cpp.html">ms_param.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Mon Mar 10 2014 13:30:21 for Gems3k by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
